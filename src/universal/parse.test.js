import * as testing from './parse.js';

describe('parse.test', () => {
  it('parses encrypted credit card data from my expired card', () => {
    expect(testing.parseSwipeData('021201801F4F28009383252A353230332A2A2A2A2A2A2A2A373230355E4142524148414D53454E2F5354455048454E20202020202020205E313830382A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A3F2A3B353230332A2A2A2A2A2A2A2A373230353D313830382A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A3F2A66AE219667CDAD7B1C8F794D4980F9E39CB12C8D76CC8EEE3B9A5BF7502EF740334EA67B5733FE190C16667EE44011F27A4A23B80B894759F085C5C1488CBDF5C97865E7B5DC422359C7816A087D92A499526F1F4E01FE246254C6E8B53EE22DE1F5B93C448DD73AAE8ADC21FC5DFD142A6A8A347CC1F9DF9D231EAC2E8D56BB343233543131333836376299491457002060010B5CBE03')).toEqual({
      'aes': true,
      'encrypted': true,
      'encryptedTracks': [
        '66ae219667cdad7b1c8f794d4980f9e39cb12c8d76cc8eee3b9a5bf7502ef740334ea67b5733fe190c16667ee44011f27a4a23b80b894759f085c5c1488cbdf5c97865e7b5dc422359c7816a087d92a4',
        '99526f1f4e01fe246254c6e8b53ee22de1f5b93c448dd73aae8adc21fc5dfd142a6a8a347cc1f9df9d231eac2e8d56bb',
        null,
      ],
      'ksn': '6299491457002060010b',
      'serial': '34323354313133383637',
      'tracks': [
        '252a353230332a2a2a2a2a2a2a2a373230355e4142524148414d53454e2f5354455048454e20202020202020205e313830382a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a3f2a',
        '3b353230332a2a2a2a2a2a2a2a373230353d313830382a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a3f2a',
        null,
      ],
      'valid': true,
    });
  });
  it('parses encrypted credit card data from idtech example https://atlassian.idtechproducts.com/confluence/download/attachments/30479625/80000502-001%20ID%20TECH%20Encrypted%20Data%20Output%20Formats.pdf?api=v2', () => {
    expect(testing.parseSwipeData('029801803F48236B03BF252A343236362A2A2A2A2A2A2A2A393939395E42555348204A522F47454F52474520572E4D525E2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A3F2A3B343236362A2A2A2A2A2A2A2A393939393D2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A3F2ADA7F2A52BD3F6DD8B96C50FC39C7E6AF22F06ED1F033BE0FB23D6BD33DC5A1F808512F7AE18D47A60CC3F4559B1B093563BE7E07459072ABF8FAAB5338C6CC8815FF87797AE3A7BEAB3B10A3FBC230FBFB941FAC9E82649981AE79F2632156E775A06AEDAFAF6F0A184318C5209E55AD44A9CCF6A78AC240F791B63284E15B4019102BA6C505814B585816CA3C2D2F42A99B1B9773EF1B116E005B7CD8681860D174E6AD316A0ECDBC687115FC89360AEE7E430140A7B791589CCAADB6D6872B78433C3A25DA9DDAE83F12FEFAB530CE405B701131D2FBAAD970248A456000933418AC88F65E1DB7ED4D10973F99DFC8463FF6DF113B6226C4898A9D355057ECAF11A5598F02CA31688861C157C1CE2E0F72CE0F3BB598A614EAABB16299490119000000000206E203')).toEqual({
      'aes': false,
      'encrypted': true,
      'encryptedTracks': [
        'da7f2a52bd3f6dd8b96c50fc39c7e6af22f06ed1f033be0fb23d6bd33dc5a1f808512f7ae18d47a60cc3f4559b1b093563be7e07459072abf8faab5338c6cc8815ff87797ae3a7be',
        'ab3b10a3fbc230fbfb941fac9e82649981ae79f2632156e775a06aedafaf6f0a184318c5209e55ad',
        '44a9ccf6a78ac240f791b63284e15b4019102ba6c505814b585816ca3c2d2f42a99b1b9773ef1b116e005b7cd8681860d174e6ad316a0ecdbc687115fc89360aee7e430140a7b791589ccaadb6d6872b78433c3a25da9ddae83f12fefab530ce405b701131d2fbaad970248a45600093',
      ],
      'ksn': '62994901190000000002',
      'serial': null,
      'tracks': [
        '252a343236362a2a2a2a2a2a2a2a393939395e42555348204a522f47454f52474520572e4d525e2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a3f2a',
        '3b343236362a2a2a2a2a2a2a2a393939393d2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a3f2a',
        null,
      ],
      'valid': true,
    });
  });
});
