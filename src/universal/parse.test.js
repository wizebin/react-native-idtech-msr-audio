import * as testing from './parse.js';

describe('parse.test', () => {
  it('parses encrypted credit card data from my expired card', () => {
    expect(testing.parseSwipeData('021201801F4F28009383252A353230332A2A2A2A2A2A2A2A373230355E4142524148414D53454E2F5354455048454E20202020202020205E313830382A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A3F2A3B353230332A2A2A2A2A2A2A2A373230353D313830382A2A2A2A2A2A2A2A2A2A2A2A2A2A2A2A3F2A66AE219667CDAD7B1C8F794D4980F9E39CB12C8D76CC8EEE3B9A5BF7502EF740334EA67B5733FE190C16667EE44011F27A4A23B80B894759F085C5C1488CBDF5C97865E7B5DC422359C7816A087D92A499526F1F4E01FE246254C6E8B53EE22DE1F5B93C448DD73AAE8ADC21FC5DFD142A6A8A347CC1F9DF9D231EAC2E8D56BB343233543131333836376299491457002060010B5CBE03')).toEqual({
      'aes': true,
      'encrypted': true,
      'encrypted_tracks': [
        '66ae219667cdad7b1c8f794d4980f9e39cb12c8d76cc8eee3b9a5bf7502ef740334ea67b5733fe190c16667ee44011f27a4a23b80b894759f085c5c1488cbdf5c97865e7b5dc422359c7816a087d92a4',
        '99526f1f4e01fe246254c6e8b53ee22de1f5b93c448dd73aae8adc21fc5dfd142a6a8a347cc1f9df9d231eac2e8d56bb',
        null,
      ],
      'ksn': '6299491457002060010b',
      'payload': '66ae219667cdad7b1c8f794d4980f9e39cb12c8d76cc8eee3b9a5bf7502ef740334ea67b5733fe190c16667ee44011f27a4a23b80b894759f085c5c1488cbdf5c97865e7b5dc422359c7816a087d92a499526f1f4e01fe246254c6e8b53ee22de1f5b93c448dd73aae8adc21fc5dfd142a6a8a347cc1f9df9d231eac2e8d56bb',
      'serial': '34323354313133383637',
      'tracks': [
        '252a353230332a2a2a2a2a2a2a2a373230355e4142524148414d53454e2f5354455048454e20202020202020205e313830382a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a3f2a',
        '3b353230332a2a2a2a2a2a2a2a373230353d313830382a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a3f2a',
        null,
      ],
      'valid': true,
    });
  });
});
